create table category (
id int NOT NULL IDENTITY (1,1),
name varchar(50) not null,
primary key (id)
);

create table subcategory (
id int NOT NULL IDENTITY (1,1),
name varchar(50) not null,
category_id int,
primary key (id),
foreign key (category_id) references category(id)
)

create table product_type (
id int NOT NULL IDENTITY (1,1),
name varchar(50) not null,
subcategory_id int  not null,
primary key (id),
foreign key (subcategory_id) references subcategory(id)
)

create table filter (
id int NOT NULL IDENTITY (1,1),
name varchar(50) not null,
prodtype_id int  not null,
primary key (id),
foreign key (prodtype_id) references product_type (id)
)

create table filter_values (
id int NOT NULL IDENTITY (1,1),
filter_id int  not null,
value varchar(20) not null,
primary key (id),
foreign key (filter_id) references filter(id)
)

create table product (
id int NOT NULL IDENTITY (1,1),
name varchar(200) not null,
code varchar(50) not null,
specs varchar (1000) not null,
price float(10) not null, 
offer float(10),
prodtype_id int  not null,
items int  not null,
primary key (id),
foreign key (prodtype_id) references product_type(id),
)

create table product_filters(
id int NOT NULL IDENTITY (1,1),
value_id int  not null,
product_id int not null,
primary key (id),
foreign key (value_id) references filter_values(id),
foreign key (product_id) references product(id)
)

CREATE INDEX idx_prodCode
ON product(code);

create table review (
id int NOT NULL IDENTITY (1,1),
name varchar(50) not null,
comment varchar(500) not null,
product_id int,
stars int not null,
primary key (id),
foreign key (product_id) references product(id)
)

create table pics (
id int NOT NULL IDENTITY (1,1),
pic_path varchar(200) not null,
product_id int  not null,
primary key (id),
foreign key (product_id) references product(id)
)

CREATE INDEX idx_picPath
ON pics(pic_path);

create table privileges (
id int NOT NULL IDENTITY (1,1),
name varchar(20) not null,
primary key (id)
)

create table users (
id int NOT NULL IDENTITY (1,1),
first_name varchar(50) not null,
last_name varchar(50) not null,
privileges int  not null,
location varchar(100) not null,
phone varchar(12) not null,
email varchar(30) not null,
primary key(id),
foreign key(privileges) references privileges(id)
)

CREATE INDEX idx_userEmail
ON users(email);

create table shipping (
id int NOT NULL IDENTITY (1,1),
name varchar(50) not null,
cost float(5) not null,
primary key(id)
)

create table payment (
id int NOT NULL IDENTITY (1,1),
name varchar(50) not null,
primary key (id)
)

create table order_status (
id int NOT NULL IDENTITY (1,1),
name varchar(20) not null,
primary key (id)
)

create table orders (
id int NOT NULL IDENTITY (1,1),
first_name varchar(50) not null,
last_name varchar(50) not null,
location varchar(100) not null,
phone varchar(12) not null,
email varchar(30) not null,
status_id int  not null,
total float(10) not null,
dt datetime not null,
shipping_id int  not null,
payment_id int,
primary key (id),
foreign key (status_id) references order_status(id),
foreign key (shipping_id) references shipping (id),
foreign key (payment_id) references payment(id)
)

create table customer_orders (
id int NOT NULL IDENTITY (1,1),
customer_id int,
order_id int,
primary key (id),
foreign key (customer_id) references users (id),
foreign key (order_id) references orders (id)
)

create table product_list (
id int NOT NULL IDENTITY (1,1),
order_id int,
product_id int,
no_items int not null,
primary key (id),
foreign key (order_id) references orders (id),
foreign key (product_id) references product (id)
)
